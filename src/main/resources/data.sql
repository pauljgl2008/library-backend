DROP TABLE IF EXISTS AUTHOR;
DROP TABLE IF EXISTS BOOK;
DROP TABLE IF EXISTS LOAN;

CREATE TABLE AUTHOR (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR2(255) NOT NULL,
    NATIONALITY VARCHAR2(100),
    BIRTH_DATE DATE
);

CREATE TABLE BOOK (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TITLE VARCHAR2(255) NOT NULL,
    AUTHOR_ID NUMBER NOT NULL,
    ISBN VARCHAR2(50) UNIQUE NOT NULL,
    PUBLICATION_DATE DATE,
    STATUS VARCHAR2(50) CHECK (status IN ('Disponible', 'No disponible')),
    FOREIGN KEY (AUTHOR_ID) REFERENCES AUTHOR(ID)
);

CREATE TABLE LOAN (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    LOAN_DATE DATE NOT NULL,
    RETURN_DATE DATE,
    STATUS VARCHAR2(50) CHECK (status IN ('Activo', 'Finalizado')),
    BOOK_ID NUMBER,
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK(ID)
);

-- Data for Author Table
INSERT INTO AUTHOR (NAME, NATIONALITY, BIRTH_DATE)
VALUES ('J.K. Rowling', 'British', '1965-07-31');
INSERT INTO AUTHOR (NAME, NATIONALITY, BIRTH_DATE)
VALUES ('George Orwell', 'British', '1903-06-25');

-- Data for Book Table
INSERT INTO BOOK (TITLE, AUTHOR_ID, ISBN, PUBLICATION_DATE, STATUS)
VALUES ('Harry Potter and the Sorcerer Stone', 1, '978-0439708180', '1997-06-26', 'Disponible');
INSERT INTO BOOK (TITLE, AUTHOR_ID, ISBN, PUBLICATION_DATE, STATUS)
VALUES ('Book 1984', 2, '978-0451524935', '1949-06-08', 'No disponible');

-- Data for Loan Table
INSERT INTO LOAN (LOAN_DATE, RETURN_DATE, STATUS, BOOK_ID)
VALUES ('2024-11-01', '2024-12-15', 'Activo', 1);
INSERT INTO LOAN (LOAN_DATE, RETURN_DATE, STATUS, BOOK_ID)
VALUES ('2024-11-05', '2024-12-20', 'Activo', 2);
